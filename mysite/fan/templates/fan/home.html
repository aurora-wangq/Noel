{% load static %}

<link rel="stylesheet" href="/static/css/bulma.css" />
<!DOCTYPE html>
<html>

<head>
    <link rel="shortcut icon" href="{% static 'images/favicon.ico' %}">
    <link rel="shortcut icon" href="{% static 'favicon.ico' %}"/>

<link rel="bookmark" href="{% static 'favicon.ico' %}"/>
  {% include "fan/components/head.html" %}
  <style>
    .mdui-grid-tile>a>.post-image-blur {
      filter: blur(64px);
      transition: filter 300ms;
    }

    .mdui-grid-tile>a>.post-image {
      height: 300px;
      object-fit: cover;
      transition: filter 300ms;
    }

    html {
      background-image: url('/static/images/homeback.jpg');
      height: 100%;
      background-position: center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      background-size: cover;
    }

    body {
      background: none;
      /* backdrop-filter: blur(12px); */
    }

    .mdui-drawer {
      backdrop-filter: blur(48px) brightness(150%);
    }

    .posts-view {
      display: block;
      padding: 70px 0;
    }
  </style>
</head>

<body class="mdui-appbar-with-toolbar " >
  {% csrf_token %}

  {% include "fan/components/appbar.html" with page="首页" %}

  {% include "fan/components/drawer.html" %}

  <button class="mdui-fab mdui-fab-fixed mdui-ripple mdui-color-pink-200" mdui-dialog="{target: '#new-post-dialog'}">
    <i class="mdui-icon material-icons">add</i>
  </button>

  <div class="mdui-dialog" id="new-post-dialog">
    <div class="mdui-dialog-title">新帖子</div>
    <div class="mdui-dialog-content">
      <form action="/edit/" method="post" enctype="multipart/form-data" id="submit-form">
        {% csrf_token %}
        <div class="mdui-container">
          <div class="mdui-row">
            <div class="mdui-textfield">
              <i class="mdui-icon material-icons"> >- </i>
              <textarea class="mdui-textfield-input" name="content" rows="3" placeholder="写点啥呢~"></textarea>
            </div>
          </div>

          <br />

          <div>
            <i class="mdui-icon material-icons">visibility</i>
            <label class="mdui-checkbox" style="margin-left: 24px">
              <input type="checkbox" name="show_view" value="true" />
              <i class="mdui-checkbox-icon"></i>是否含有R18内容
            </label>
          </div>

          <br />

          <div>
                        <div class="file">
  <label class="file-label" >
    <input class="file-input" type="file" name="post_img1">
    <span class="file-cta">
      <span class="file-icon">
        <i class="mdui-icon material-icons">&#xe3e0;</i>
      </span>
      <span class="file-label" style="padding: 20px">
        选择图片....
      </span>
    </span>
  </label>
</div>
          </div>
        </div>

      </form>
    </div>
    <div class="mdui-dialog-actions">
      <button class="mdui-btn mdui-ripple" mdui-dialog-close>取消</button>
      <button class="mdui-btn mdui-ripple" id="submit-button">发布</button>
    </div>
  </div>

  <div class="mdui-container">


<hr>
<div class="mdui-divider"></div>
      <h1 style="font-weight:300; font-size: 30px;padding:4px; text-align:center">每一个人，只要活着，就会不停的失去。
      </h1>
   <div class="mdui-divider"></div>
    <hr>

    <div class="mdui-row">

      {% for user in user_list1 %} {% for num in like_num_list1 %}
        {% if forloop.counter == forloop.parentloop.counter %}
      {% include "fan/content_base.html" with username=user.post_owner content=user.post_content nike_name=user.owner_profile title=user.owner_profile.title user_img1=user.owner_profile.img user_img=user like=num%}
        {% endif %}
        {% endfor %}
      {% endfor %}

    </div>

  </div>

  <script>
    document.querySelectorAll('.btn-toggle-blur').forEach(i => {
      i.addEventListener('click', (event) => {
        var elem = event.target;
        var icon;
        if (elem.tagName == 'I') {
          icon = elem;
          elem = elem.parentElement
        }
        else {
          icon = elem.querySelector('i')
        }

        if (icon.innerHTML.trim() == 'visibility') {
          icon.innerHTML = 'visibility_off';
        }
        else {
          icon.innerHTML = 'visibility';
        }
        elem.parentElement.parentElement.parentElement.querySelector('img').classList.toggle('post-image-blur');
      })
    })

    document.querySelector('#submit-button').addEventListener('click', e => {
      e.target.disabled = true;
      var elem = document.querySelector('form')
      if (elem.querySelector('input[type="file"]').value === '') {
        mdui.snackbar('File cannot be empty')
        return
      }
      elem.submit()
    })
  </script>

  <script src="https://unpkg.com/mdui@1.0.2/dist/js/mdui.min.js"></script>
</body>
<footer>

      <h1 style="font-weight:300; font-size: 15px;padding:20px; text-align:center">
        <a style="color:black" href="{% url 'fan:others_page' 1 %}">@Noel</a> <a style="color:black" href="{% url 'fan:others_page' 2 %}">@AenStarAX</a> <a style="color:black" href="{% url 'fan:others_page' 17 %}">@MoveToEx</a> | 2023
      </h1>

</footer>
</html>